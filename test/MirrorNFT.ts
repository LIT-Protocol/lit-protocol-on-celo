import { expect } from 'chai';
import { ethers } from 'hardhat';
import { MirrorNFT } from '../typechain/MirrorNFT';

describe('MirrorNFT', async function () {
  let mNFT: MirrorNFT;
  before(async function () {
    const MNFT = await ethers.getContractFactory('MirrorNFT');
    mNFT = await MNFT.deploy('0x390F478e10490947f11d0b5afDcB3EAbc049fdB4');
    console.log(mNFT.address);
    // mNFT = await MNFT.attach('');
  });
  it('claim', async function () {
    const headerJSON = '{"alg":"BLS12-381","typ":"JWT"}';
    const payloadJSON =
      '{"iss":"LIT","chain":"ethereum","iat":1639308148,"exp":1639351348,"callRequests":[{"to":"0x1dfe7ca09e99d10835bf73044a23b73fc20623df","data":"0xc87b56dd00000000000000000000000000000000000000000000000000000000000d5ad8"},{"to":"0x1dfe7ca09e99d10835bf73044a23b73fc20623df","data":"0x6352211e00000000000000000000000000000000000000000000000000000000000d5ad8"}],"callResponses":["0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000006e1646174613a6170706c69636174696f6e2f6a736f6e3b6261736536342c65794a755957316c496a6f67496b4a685a79416a4f4463314d6a493049697767496d526c63324e796158423061573975496a6f67496b3176636d55675447397664434270637942685a47527064476c76626d467349484a68626d527662576c365a575167595752325a57353064584a6c6369426e5a5746794947646c626d56795958526c5a434268626d516763335276636d566b4947397549474e6f59576c754c69424e595868706258567449484e3163484273655342706379426b6557356862576c6a4c434270626d4e795a57467a6157356e49474630494445764d544230614342765a6942466447686c636d56316253647a49474a7362324e7249484a686447557549464e305958527a4c4342706257466e5a584d73494746755a4342766447686c6369426d6457356a64476c76626d467361585235494746795a534270626e526c626e5270623235686247783549473974615852305a5751675a6d397949473930614756796379423062794270626e526c636e42795a58517549455a6c5a5777675a6e4a6c5a5342306279423163325567545739795a53424d6232393049476c75494746756553423359586b676557393149486468626e517549697767496d6c745957646c496a6f67496d526864474536615731685a32557663335a6e4b3368746244746959584e6c4e6a51735545684f4d6c7035516a52695633683159336f7761574649556a426a5247393254444e6b4d3252354e544e4e655456325932316a646b31715158644e517a6c365a47316a61556c49516e6c61574535735932356162464659546e646156303477565731474d4746584f446c4a626d684f59566331576c52586248564a527a4673576c685261556c49576e426157475244596a4e6e4f556c715157644e51304636546c52425a3031365658644a616a5134597a4e534e574a485653744d6255706f597a4a565a325635516d31685633687a54326c434d3246486244426156484e6e576d3035645752444d57315a567a4677596b68724e6b6c49546d786a6257787454336c43625749794e54424d574535775a5731564e6b6c455254426a53476333535567774f45777a546a426c563368735547703465567058546a424a53475277576b6853623142545358684e5245467353576c43623170586247356853464535535770466430314456576c4a52317077596b64334f556c74536e4e5a5630357953576c42646c427165444261574767775355686e4f556c715258644a6155493155464e4a655531445357645a4d6e686f597a4e4e4f556c74536d686a4d6c56705547786b61474a745554684d4d314a735a5568524b314249556d786c5346466e5a5551776155315551576c4a534773355357705264306c70516d706952305a3659336f7761566c74526e706155306b72556b64734d6d46584e57784a526b7032575731564f45777a556d786c5346457255456853624756495557646c524442705456524261556c49617a6c4a616c6c3353576c43616d4a48526e706a656a427057573147656c70545353744a62464a73596c684362474d7a555764564d6d68325a46685261556c46556e426b62577831576c4e43535749794f57744a527a6c745355566b63466c584e54426a6555467954565233646d5248566a526b524451345a4564574e475244516a525155306c3454554e4a5a3256554d476c50524546705355644f63316c59546e7051553070705756684f62456c714e56525a5745357655454d354d46705961444251616e6777576c686f4d456c495a7a6c4a616b563353576c434e5642545358684e524546705355644f63316c59546e7051553070705756684f62456c714e553161563059775955645765556c46536e5a694d314a365355633562556c46536e6c685633687a5956644764566b795654684d4d314a735a5568524b314249556d786c5346466e5a5551776155315551576c4a5347733553577046655531445357645a4d6e686f597a4e4e4f556c74536d686a4d6c56705547744f62316c586248564a5257527a596a4e6162474e3664335a6b523159305a4551304f475248566a526b5130493055464e4a654531445357646c564442705456525264306c70516d706952305a3659336f7761566c74526e706155306b72535774534d574d79633264564d315a3153576c43516d4a59566e4e615746466e596a4a5a5a314a584e584e68563252765a45645764574a58566e566b524864325a4564574e4752454e44686b523159305a454e434e4642545358684e51306c6e5a565177615531555758644a61554a71596b6447656d4e364d476c5a62555a36576c4e4a4b31557962484e6b62565a3553555a4b63474a74597a684d4d314a735a5568524b3142444f58706b62574d72496e303d00000000000000000000000000000000000000000000000000000000000000","0x000000000000000000000000f8f7873f80039d59783e7059ecff5a6c49d70d47"]}';
    const sig =
      '0x00000000000000000000000000000000080a1a16f9d036577d4f44deb6e6ae752bf7239b8645254f11815a788be38f876f8085132a28cdce8b2d495167d350960000000000000000000000000000000008cb40929c6451968c1a4045963f6cef676800a12294781a34f161c296d07d3324260cc595ee0efa699f873fefb14ed900000000000000000000000000000000063935f57e619a2105d1c72f519ef44e9de2c1c8543f283de57f72af21735212a445daefa29a2849646e17dd0bb629f000000000000000000000000000000000007560ff72e01108f4c2ebf87b58af49a0af57b076a9137b67d1b109fa62c769cb8107247acafaf19978af3cb82c90ef';

    await mNFT.claim(headerJSON, payloadJSON, sig);
    expect(await mNFT.totalSupply()).equal(1);
    console.log(await mNFT.ownerOf(1));
    console.log(await mNFT.tokenURI(1));
  });
});
